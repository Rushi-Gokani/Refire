{% doc %}
  @prompt
    make a full width banner, with height controllable where we'll have to put the image. on the banner, we'll put the heading text that will be center aligned, and below that will be breadcrumbs. and on mobile it should have a separate image input. in case the separate image is not uploaded, the fallback will be the desktop image banner
{% enddoc %}
{% assign ai_gen_id = block.id | replace: '_', '' | downcase %}

{% style %}
  .ai-banner-container-{{ ai_gen_id }} {
    position: relative;
    width: 100%;
    height: {{ block.settings.banner_height }}px;
    overflow: hidden;
    display: flex;
    align-items: center;
    justify-content: center;
    background-color: {{ block.settings.overlay_color }};
  }

  .ai-banner-image-{{ ai_gen_id }} {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
    z-index: 1;
  }

  .ai-banner-placeholder-{{ ai_gen_id }} {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: #f4f4f4;
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 1;
  }

  .ai-banner-placeholder-{{ ai_gen_id }} svg {
    width: 100%;
    height: 100%;
    max-width: 300px;
    max-height: 300px;
    opacity: 0.3;
  }

  .ai-banner-overlay-{{ ai_gen_id }} {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: {{ block.settings.overlay_color }};
    opacity: {{ block.settings.overlay_opacity | divided_by: 100.0 }};
    z-index: 2;
  }

  .ai-banner-content-{{ ai_gen_id }} {
    position: relative;
    z-index: 3;
    text-align: center;
    color: {{ block.settings.text_color }};
    max-width: 800px;
    padding: 0 20px;
  }

  .ai-banner-heading-{{ ai_gen_id }} {
    font-family: {{ settings.type_heading_font.family }}, {{ settings.type_heading_font.fallback_families }};
    font-weight: {{ settings.type_heading_font.weight }};
    font-size: {{ block.settings.heading_size }}px;
    line-height: 1.2;
    margin: 0 0 20px;
    color: {{ block.settings.text_color }};
    text-transform: {{ settings.type_case_h1 }};
  }

  .ai-banner-breadcrumbs-{{ ai_gen_id }} {
    font-family: {{ settings.type_body_font.family }}, {{ settings.type_body_font.fallback_families }};
    font-weight: {{ settings.type_body_font.weight }};
    font-size: {{ block.settings.breadcrumb_size }}px;
    color: {{ block.settings.breadcrumb_color }};
    margin: 0;
  }

  .ai-banner-breadcrumb-link-{{ ai_gen_id }} {
    color: {{ block.settings.breadcrumb_color }};
    text-decoration: none;
    opacity: 0.8;
    transition: opacity 0.3s ease;
  }

  .ai-banner-breadcrumb-link-{{ ai_gen_id }}:hover {
    opacity: 1;
    text-decoration: underline;
  }

  .ai-banner-breadcrumb-separator-{{ ai_gen_id }} {
    margin: 0 8px;
    opacity: 0.6;
  }

  .ai-banner-empty-state-{{ ai_gen_id }} {
    position: absolute;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    padding: 12px 20px;
    font-size: 14px;
    color: #666;
    text-align: center;
    pointer-events: none;
    z-index: 4;
  }

  @media screen and (max-width: 749px) {
    .ai-banner-container-{{ ai_gen_id }} {
      height: {{ block.settings.mobile_banner_height }}px;
    }

    .ai-banner-heading-{{ ai_gen_id }} {
      font-size: {{ block.settings.mobile_heading_size }}px;
    }

    .ai-banner-breadcrumbs-{{ ai_gen_id }} {
      font-size: {{ block.settings.mobile_breadcrumb_size }}px;
    }

    .ai-banner-content-{{ ai_gen_id }} {
      padding: 0 15px;
    }
  }
{% endstyle %}

<div
  class="ai-banner-container-{{ ai_gen_id }}"
  {{ block.shopify_attributes }}
>
  {% if block.settings.mobile_image and block.settings.mobile_image != blank %}
    {% comment %} Mobile image {% endcomment %}
    <img
      src="{{ block.settings.mobile_image | image_url: width: 1200 }}"
      alt="{{ block.settings.mobile_image.alt | escape }}"
      loading="lazy"
      width="{{ block.settings.mobile_image.width }}"
      height="{{ block.settings.mobile_image.height }}"
      class="ai-banner-image-{{ ai_gen_id }}"
      style="display: block;"
      media="(max-width: 749px)"
    >
    {% if block.settings.desktop_image and block.settings.desktop_image != blank %}
      <img
        src="{{ block.settings.desktop_image | image_url: width: 2000 }}"
        alt="{{ block.settings.desktop_image.alt | escape }}"
        loading="lazy"
        width="{{ block.settings.desktop_image.width }}"
        height="{{ block.settings.desktop_image.height }}"
        class="ai-banner-image-{{ ai_gen_id }}"
        style="display: none;"
        media="(min-width: 750px)"
      >
    {% endif %}
  {% elsif block.settings.desktop_image and block.settings.desktop_image != blank %}
    {% comment %} Desktop image (fallback for mobile) {% endcomment %}
    <img
      src="{{ block.settings.desktop_image | image_url: width: 2000 }}"
      alt="{{ block.settings.desktop_image.alt | escape }}"
      loading="lazy"
      width="{{ block.settings.desktop_image.width }}"
      height="{{ block.settings.desktop_image.height }}"
      class="ai-banner-image-{{ ai_gen_id }}"
    >
  {% else %}
    {% comment %} Placeholder {% endcomment %}
    <div class="ai-banner-placeholder-{{ ai_gen_id }}">
      {{ 'hero-apparel-1' | placeholder_svg_tag }}
    </div>
    <div class="ai-banner-empty-state-{{ ai_gen_id }}">
      Next, add banner images
    </div>
  {% endif %}

  {% if block.settings.show_overlay %}
    <div class="ai-banner-overlay-{{ ai_gen_id }}"></div>
  {% endif %}

  <div class="ai-banner-content-{{ ai_gen_id }}">
    {% if block.settings.heading != blank %}
      <h1 class="ai-banner-heading-{{ ai_gen_id }}">{{ block.settings.heading }}</h1>
    {% endif %}

    {% if block.settings.show_breadcrumbs %}
      <nav class="ai-banner-breadcrumbs-{{ ai_gen_id }}" aria-label="Breadcrumb">
        {% unless template == 'index' %}
          <a href="{{ routes.root_url }}" class="ai-banner-breadcrumb-link-{{ ai_gen_id }}">Home</a>
          <span class="ai-banner-breadcrumb-separator-{{ ai_gen_id }}">/</span>
        {% endunless %}

        {% case template.name %}
          {% when 'collection' %}
            <span>{{ collection.title }}</span>
          {% when 'product' %}
            {% if collection %}
              <a href="{{ collection.url }}" class="ai-banner-breadcrumb-link-{{ ai_gen_id }}">{{ collection.title }}</a>
              <span class="ai-banner-breadcrumb-separator-{{ ai_gen_id }}">/</span>
            {% endif %}
            <span>{{ product.title }}</span>
          {% when 'page' %}
            <span>{{ page.title }}</span>
          {% when 'blog' %}
            <span>{{ blog.title }}</span>
          {% when 'article' %}
            <a href="{{ blog.url }}" class="ai-banner-breadcrumb-link-{{ ai_gen_id }}">{{ blog.title }}</a>
            <span class="ai-banner-breadcrumb-separator-{{ ai_gen_id }}">/</span>
            <span>{{ article.title }}</span>
          {% when 'search' %}
            <span>Search</span>
          {% when 'cart' %}
            <span>Cart</span>
          {% when 'account' %}
            <span>Account</span>
          {% when 'login' %}
            <span>Login</span>
          {% when 'register' %}
            <span>Register</span>
          {% when '404' %}
            <span>Page not found</span>
          {% else %}
            {% if template == 'index' %}
              <span>Home</span>
            {% else %}
              <span>{{ page_title }}</span>
            {% endif %}
        {% endcase %}
      </nav>
    {% endif %}
  </div>
</div>

<script>
  (function() {
    function handleResponsiveImages() {
      const container = document.querySelector('.ai-banner-container-{{ ai_gen_id }}');
      if (!container) return;

      const images = container.querySelectorAll('.ai-banner-image-{{ ai_gen_id }}');
      
      function updateImageVisibility() {
        const isMobile = window.innerWidth <= 749;
        
        images.forEach((img) => {
          const media = img.getAttribute('media');
          if (media === '(max-width: 749px)') {
            img.style.display = isMobile ? 'block' : 'none';
          } else if (media === '(min-width: 750px)') {
            img.style.display = isMobile ? 'none' : 'block';
          }
        });
      }

      updateImageVisibility();
      window.addEventListener('resize', updateImageVisibility);
    }

    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', handleResponsiveImages);
    } else {
      handleResponsiveImages();
    }
  })();
</script>

{% schema %}
{
  "name": "Full width banner",
  "tag": null,
  "settings": [
    {
      "type": "header",
      "content": "Images"
    },
    {
      "type": "image_picker",
      "id": "desktop_image",
      "label": "Desktop image"
    },
    {
      "type": "image_picker",
      "id": "mobile_image",
      "label": "Mobile image"
    },
    {
      "type": "paragraph",
      "content": "If no mobile image is uploaded, the desktop image will be used as fallback."
    },
    {
      "type": "header",
      "content": "Banner dimensions"
    },
    {
      "type": "range",
      "id": "banner_height",
      "min": 200,
      "max": 800,
      "step": 20,
      "unit": "px",
      "label": "Desktop height",
      "default": 400
    },
    {
      "type": "range",
      "id": "mobile_banner_height",
      "min": 200,
      "max": 600,
      "step": 20,
      "unit": "px",
      "label": "Mobile height",
      "default": 300
    },
    {
      "type": "header",
      "content": "Content"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Welcome to our store"
    },
    {
      "type": "checkbox",
      "id": "show_breadcrumbs",
      "label": "Show breadcrumbs",
      "default": true
    },
    {
      "type": "header",
      "content": "Overlay"
    },
    {
      "type": "checkbox",
      "id": "show_overlay",
      "label": "Show overlay",
      "default": true
    },
    {
      "type": "color",
      "id": "overlay_color",
      "label": "Overlay color",
      "default": "#000000"
    },
    {
      "type": "range",
      "id": "overlay_opacity",
      "min": 0,
      "max": 80,
      "step": 5,
      "unit": "%",
      "label": "Overlay opacity",
      "default": 30
    },
    {
      "type": "header",
      "content": "Text styling"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Text color",
      "default": "#ffffff"
    },
    {
      "type": "range",
      "id": "heading_size",
      "min": 24,
      "max": 80,
      "step": 2,
      "unit": "px",
      "label": "Desktop heading size",
      "default": 48
    },
    {
      "type": "range",
      "id": "mobile_heading_size",
      "min": 20,
      "max": 60,
      "step": 2,
      "unit": "px",
      "label": "Mobile heading size",
      "default": 32
    },
    {
      "type": "color",
      "id": "breadcrumb_color",
      "label": "Breadcrumb color",
      "default": "#ffffff"
    },
    {
      "type": "range",
      "id": "breadcrumb_size",
      "min": 12,
      "max": 20,
      "step": 1,
      "unit": "px",
      "label": "Desktop breadcrumb size",
      "default": 14
    },
    {
      "type": "range",
      "id": "mobile_breadcrumb_size",
      "min": 10,
      "max": 18,
      "step": 1,
      "unit": "px",
      "label": "Mobile breadcrumb size",
      "default": 12
    }
  ],
  "presets": [
    {
      "name": "Full width banner"
    }
  ]
}
{% endschema %}